# éŸ³é¢‘é¢„å¤„ç†é“¾è°ƒè¯•æŒ‡å—

## ğŸš¨ é—®é¢˜è¯Šæ–­
VADå…¨é™éŸ³é—®é¢˜å¯èƒ½ç”±éŸ³é¢‘é¢„å¤„ç†é“¾ä¸­çš„æŸä¸ªç¯èŠ‚å¼•èµ·ã€‚å·²ä¸´æ—¶ç¦ç”¨æ‰€æœ‰é¢„å¤„ç†æ­¥éª¤è¿›è¡Œæ’æŸ¥ã€‚

## ğŸ”§ å½“å‰é…ç½®ï¼ˆå…¨éƒ¨ç¦ç”¨ï¼‰
```cpp
use_pre_emphasis = false;     // é¢„åŠ é‡
use_high_pass = false;        // é«˜é€šæ»¤æ³¢  
use_agc = false;              // AGCè‡ªåŠ¨å¢ç›Šæ§åˆ¶ âš ï¸ é‡ç‚¹æ€€ç–‘å¯¹è±¡
use_compression = false;      // åŠ¨æ€èŒƒå›´å‹ç¼©
use_noise_suppression = false; // å™ªå£°æŠ‘åˆ¶
use_final_gain = false;       // æœ€ç»ˆå¢ç›Šæ”¾å¤§
```

## ğŸ” è°ƒè¯•è¾“å‡ºè¯´æ˜

### æ­£å¸¸æƒ…å†µåº”è¯¥çœ‹åˆ°ï¼š
```
[AudioPreprocessor::process] åŸå§‹éŸ³é¢‘ - RMS: 0.025, æœ€å¤§å€¼: 0.15, æ ·æœ¬æ•°: 160
[AudioPreprocessor::process] æœ€ç»ˆéŸ³é¢‘ - RMS: 0.025, æœ€å¤§å€¼: 0.15, å˜åŒ–: 100.0%
=====================================
```

### å¼‚å¸¸æƒ…å†µï¼ˆéŸ³é¢‘è¢«ç ´åï¼‰ï¼š
```
[AudioPreprocessor::process] åŸå§‹éŸ³é¢‘ - RMS: 0.025, æœ€å¤§å€¼: 0.15, æ ·æœ¬æ•°: 160
[AudioPreprocessor::process] æœ€ç»ˆéŸ³é¢‘ - RMS: 0.001, æœ€å¤§å€¼: 0.01, å˜åŒ–: 4.0%
=====================================
```

## ğŸ§ é‡ç‚¹æ€€ç–‘çš„é—®é¢˜

### 1. AGCç®—æ³•ç¼ºé™·
```cpp
// é—®é¢˜ä»£ç ï¼š
float alpha_attack = (rms > current_gain * rms) ? attack_time : release_time;
```
**é—®é¢˜**ï¼šæ¡ä»¶ `rms > current_gain * rms` é€»è¾‘é”™è¯¯
**åæœ**ï¼šå¯èƒ½å¯¼è‡´å¢ç›Šè®¡ç®—å¼‚å¸¸

### 2. AGCå‚æ•°ä¸åˆç†
```cpp
target_level(0.1f)    // ç›®æ ‡ç”µå¹³è¿‡ä½
min_gain(0.1f)        // æœ€å°å¢ç›Š0.1ä¼šä¸¥é‡è¡°å‡ä¿¡å·
max_gain(10.0f)       // æœ€å¤§å¢ç›Šè¿‡é«˜
```

### 3. å‹ç¼©ç®—æ³•é—®é¢˜
```cpp
float gain_reduction = 1.0f + (compression_threshold - abs_sample) * 
                      (1.0f - 1.0f/compression_ratio) / compression_threshold;
```
**å¯èƒ½é—®é¢˜**ï¼šå¢ç›Šå‡å°‘è®¡ç®—å¯èƒ½æœ‰è¯¯

## ğŸ“‹ æ’æŸ¥æ­¥éª¤

### ç¬¬1æ­¥ï¼šéªŒè¯ç¦ç”¨çŠ¶æ€
ç¼–è¯‘è¿è¡Œï¼Œç¡®è®¤æ‰€æœ‰é¢„å¤„ç†éƒ½è¢«è·³è¿‡ï¼ŒéŸ³é¢‘ä¿æŒåŸæ ·ã€‚

### ç¬¬2æ­¥ï¼šé€ä¸ªå¯ç”¨æµ‹è¯•
å¦‚æœç¬¬1æ­¥æ­£å¸¸ï¼Œé€ä¸ªå¯ç”¨é¢„å¤„ç†æ­¥éª¤ï¼š

1. **å¯ç”¨é¢„åŠ é‡**ï¼š`use_pre_emphasis = true`
2. **å¯ç”¨é«˜é€šæ»¤æ³¢**ï¼š`use_high_pass = true`  
3. **å¯ç”¨AGC**ï¼š`use_agc = true` âš ï¸ é‡ç‚¹è§‚å¯Ÿ
4. **å¯ç”¨å‹ç¼©**ï¼š`use_compression = true`

### ç¬¬3æ­¥ï¼šä¿®å¤é—®é¢˜ç®—æ³•
æ‰¾åˆ°é—®é¢˜ç¯èŠ‚åï¼Œä¿®å¤ç›¸åº”ç®—æ³•ã€‚

## ğŸ› ï¸ é¢„æœŸä¿®å¤æ–¹æ¡ˆ

### AGCç®—æ³•ä¿®å¤
```cpp
// ä¿®å¤åçš„AGCé€»è¾‘
float desired_gain = target_level / (rms + 1e-6f);
desired_gain = clamp(desired_gain, 0.5f, 3.0f);  // æ›´åˆç†çš„å¢ç›ŠèŒƒå›´

// ä¿®å¤å¹³æ»‘é€»è¾‘
float alpha = (desired_gain > current_gain) ? attack_time : release_time;
current_gain = alpha * desired_gain + (1.0f - alpha) * current_gain;
```

### å‚æ•°è°ƒæ•´
```cpp
target_level(0.3f)    // æé«˜ç›®æ ‡ç”µå¹³
min_gain(0.5f)        // æé«˜æœ€å°å¢ç›Š
max_gain(3.0f)        // é™ä½æœ€å¤§å¢ç›Š
```

## ğŸ¯ æˆåŠŸæ ‡å‡†
ä¿®å¤ååº”è¯¥çœ‹åˆ°ï¼š
- åŸå§‹éŸ³é¢‘ç”µå¹³ä¿æŒåˆç†èŒƒå›´
- VADèƒ½æ­£å¸¸æ£€æµ‹è¯­éŸ³æ´»åŠ¨
- éŸ³é¢‘è´¨é‡ä¸å—æ˜æ˜¾å½±å“ 